
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Giỏ hàng của tôi — Thor</title>
  <meta name="description" content="Trang giỏ hàng cá nhân: ảnh sản phẩm riêng, hiệu ứng Tết đỏ–vàng, Quick View và giỏ hàng cục bộ." />

  <style>
    :root{
      /* Tông đỏ–vàng Tết */
      --bg:#3b0a19; --bg2:#4a0f22; --bg-alt:#561630;
      --gold:#ffd166; --gold2:#ffea9a; --text:#fff3f3; --muted:#e9bfc3;
      --border:#7a2138; --shadow:0 26px 80px rgba(0,0,0,.45);
      --radius:18px; --wrap:1100px; --headerH:64px;
    }
    html,body{
      margin:0; padding:0; color:var(--text);
      font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;
      background:
        radial-gradient(1000px 420px at 15% -10%, rgba(255,218,121,.25), transparent 60%),
        radial-gradient(1100px 520px at 85% -20%, rgba(235,82,62,.18), transparent 60%),
        linear-gradient(180deg, var(--bg2) 0%, var(--bg) 55%, #330715 100%);
    }
    a{ color:#ffe79f; text-decoration:none }
    a:hover{ text-decoration:underline }
    img{ max-width:100%; display:block }
    .wrap{ max-width:var(--wrap); margin:0 auto; padding:0 22px }

    /* ===== HEADER ===== */
    .site-header{
      position:sticky; top:0; z-index:999; height:var(--headerH);
      background:rgba(86,22,48,.65); backdrop-filter:blur(10px) saturate(1.1);
      border-bottom:1px solid var(--border);
    }
    .nav{ height:100%; display:flex; align-items:center; justify-content:space-between }
    .brand{ display:flex; align-items:center; gap:14px }
    .logoBadge{
      width:40px; height:40px; border-radius:14px;
      display:grid; place-items:center;
      background:radial-gradient(circle at 30% 25%, var(--gold2) 0%, var(--gold) 55%, #f7c35f 100%);
      box-shadow:0 10px 28px rgba(247,195,95,.35);
    }
    .logoBadge svg{ width:24px; height:24px; fill:#3b0a19 }
    .brandTitle{ margin:0; font-weight:900; font-size:20px; letter-spacing:.3px }

    .menu{ display:flex; gap:22px; font-weight:800 }
    .menu a{
      color:#fff; padding:8px 12px; border-radius:12px;
      transition:background .2s ease, color .2s ease;
    }
    .menu a:hover{ background:rgba(255,218,121,.15); color:#fff }

    .cartBtn{
      display:flex; align-items:center; gap:10px; border:none; cursor:pointer;
      background:radial-gradient(120% 120% at 10% 10%, var(--gold2) 0%, var(--gold) 70%, #f7c35f 100%);
      color:#3b0a19; padding:10px 14px; border-radius:999px; font-weight:900;
      box-shadow:0 12px 28px rgba(247,195,95,.4);
    }
    .cartBtn svg{ width:20px; height:20px; fill:#3b0a19 }
    .cartCount{ background:#3b0a19; color:#fff; border-radius:999px; padding:2px 8px; font-size:12px }

    /* ===== HERO ===== */
    .hero{ padding:28px 0 20px; border-bottom:1px solid var(--border) }
    .heroTitle{
      margin:.2rem 0 0; font-size:34px; line-height:1.08; font-weight:900;
      background:linear-gradient(90deg, #fff, var(--gold2), var(--gold));
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }
    .hero p{ color:var(--muted); max-width:740px; margin:10px 0 0 }

    /* ===== SECTION / GRID ===== */
    .section{ padding:32px 0; border-bottom:1px solid var(--border) }
    .section h3{ margin:0 0 16px; font-size:22px; font-weight:900 }
    .grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:16px }

    /* ===== CARD sản phẩm ===== */
    .card{
      border:1px solid var(--border); border-radius:var(--radius); background:var(--bg-alt);
      box-shadow:var(--shadow); overflow:hidden; display:flex; flex-direction:column;
    }
    .thumb{
      position:relative; aspect-ratio:4/3; background:#5a1430;
      display:flex; align-items:center; justify-content:center;
    }
    .thumb img{ width:100%; height:100%; object-fit:cover }
    /* Hiệu ứng “vòng giờ” vàng khi hover */
    .thumb::before{
      content:""; position:absolute; inset:10px; border-radius:18px;
      background:conic-gradient(from 0deg, rgba(255,218,121,.0) 0deg, rgba(255,218,121,.65) 240deg, rgba(255,218,121,.0) 360deg);
      box-shadow:0 0 0 2px rgba(255,218,121,.28) inset, 0 0 26px rgba(255,218,121,.22);
      opacity:0; transform:scale(1.02);
    }
    .card:hover .thumb::before{ opacity:1; animation:spin 2.4s linear infinite }
    @keyframes spin{ to{ transform:scale(1.02) rotate(1turn) } }

    .body{ padding:14px 14px 16px }
    .title{ margin:.35rem 0 .4rem; font-weight:900; line-height:1.25 }
    .price{ color:#ffd7a2; font-weight:900 }
    .actions{ display:flex; gap:8px; margin-top:12px; flex-wrap:wrap }
    .btn{ border:1px solid var(--border); border-radius:12px; padding:9px 12px; font-weight:800; cursor:pointer }
    .btn.primary{ background:radial-gradient(120% 120% at 10% 10%, var(--gold2) 0%, var(--gold) 70%, #f7c35f 100%); color:#3b0a19; border-color:transparent }
    .btn.outline{ background:transparent; color:#fff }
    .btn:hover{ filter:brightness(1.05) }

    /* ===== POP‑UP ===== */
    .popup{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:1000;
      background:rgba(0,0,0,.55); backdrop-filter:blur(4px) }
    .popup.show{ display:flex }
    .popupCard{
      width:min(820px,92vw); border-radius:18px; border:1px solid var(--border);
      background:var(--bg-alt); color:var(--text); box-shadow:0 28px 80px rgba(0,0,0,.55);
      transform:translateY(16px); opacity:0; animation:popIn .34s ease forwards
    }
    @keyframes popIn{ to{ transform:none; opacity:1 } }
    .popupHead{ padding:16px 18px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center }
    .popupTitle{ margin:.2rem 0 0; font-size:20px; font-weight:900 }
    .popupBody{ padding:16px 18px; display:grid; grid-template-columns:280px 1fr; gap:16px; color:var(--muted) }
    .popupBody img{ width:100%; border-radius:14px; border:1px solid var(--border) }
    .popupActions{ padding:16px 18px; border-top:1px solid var(--border); display:flex; gap:10px; justify-content:flex-end }
    .closeX{ border:none; background:transparent; color:#ffe79f; font-size:22px; cursor:pointer }

    /* ===== Drawer giỏ hàng ===== */
    .drawer{
      position:fixed; top:0; right:0; width:min(380px,92vw); height:100vh; background:var(--bg-alt); border-left:1px solid var(--border);
      box-shadow:-8px 0 24px rgba(0,0,0,.35); transform:translateX(100%); transition:transform .28s ease; z-index:1001
    }
    .drawer.show{ transform:none }
    .drawerHead{ display:flex; justify-content:space-between; align-items:center; padding:12px 14px; border-bottom:1px solid var(--border) }
    .drawerList{ padding:12px 14px; display:flex; flex-direction:column; gap:12px; max-height:calc(100vh - 200px); overflow:auto }
    .drawerItem{ display:flex; gap:10px; border:1px solid var(--border); border-radius:12px; padding:10px; background:#61152f }
    .drawerItem img{ width:64px; height:64px; object-fit:cover; border-radius:8px; border:1px solid var(--border) }
    .drawerItem .meta{ flex:1 }
    .drawerFoot{ padding:12px 14px; border-top:1px solid var(--border); display:flex; flex-direction:column; gap:10px }
    .total{ display:flex; justify-content:space-between; font-weight:900 }
    .drawerActions{ display:flex; gap:8px }
    .empty{ color:var(--muted); text-align:center; padding:20px }

    /* Nút về đầu */
    .toTop{
      position:fixed; right:18px; bottom:18px; width:44px; height:44px; display:grid; place-items:center;
      border-radius:999px; background:radial-gradient(120% 120% at 10% 10%, var(--gold2) 0%, var(--gold) 70%, #f7c35f 100%);
      color:#3b0a19; font-weight:900; box-shadow:0 14px 38px rgba(247,195,95,.35);
      cursor:pointer; opacity:0; transform:translateY(14px); transition:opacity .3s ease, transform .3s ease; z-index:999
    }
    .toTop.show{ opacity:1; transform:none }
  </style>
</head>

<body>
  <!-- ===== HEADER ===== -->
  <header class="site-header">
    <div class="wrap nav">
      <div class="brand">
        <div class="logoBadge" aria-label="Giỏ hàng của tôi">
          <!-- SVG xe đẩy -->
          <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
            <path d="M7 18a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm10 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zM6.2 6h13.6l-1.4 7H8.3l-.6-3H4V8h3.1l-.3-2zM4 6V4h2l1 5h10l1.5-8H6.1L5.8 1H1v2h3l.2 3z"/>
          </svg>
        </div>
        <h1 class="brandTitle">Giỏ hàng của tôi</h1>
      </div>

      <!-- MENU CHUẨN (KHÔNG HASHTAG) -->
      <nav class="menu">
        #sanphamSản phẩm</a>
        #giohangGiỏ hàng</a>
      </nav>

      <button id="openCart" class="cartBtn" aria-label="Mở giỏ hàng">
        <svg viewBox="0 0 24 24"><path d="M7 18a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm10 0a 2 2 0 1 0 0 4 2 2 0 0 0 0-4zM6.2 6h13.6l-1.4 7H8.3l-.6-3H4V8h3.1l-.3-2z"/></svg>
        <span>Giỏ hàng</span>
        <span id="cartCount" class="cartCount">0</span>
      </button>
    </div>
  </header>

  <!-- ===== HERO ===== -->
  <section class="hero">
    <div class="wrap">
      <h2 class="heroTitle">Bộ sưu tập Tết — Ảnh riêng</h2>
      <p>Rê chuột vào sản phẩm để xem “vòng giờ” vàng chạy quanh ảnh. Click để xem nhanh, thêm vào giỏ, hoặc mở link Shopee.</p>
    </div>
  </section>

  <!-- ===== SẢN PHẨM ===== -->
  <section id="sanpham" class="section">
    <div class="wrap">
      <h3>Sản phẩm</h3>
      <div class="grid">
        <!-- SP 1 -->
        <article class="card product" data-name="Tai nghe Bluetooth X12" data-price="299000"
                 data-summary="Pin 30h, chống ồn, sạc nhanh." data-url="https://shopee.vn/product-abc">
          <div class="thumb">images/sp_tainghe.jpg</div>
          <div class="body">
            <div class="title">Tai nghe Bluetooth X12</div>
            <div class="price">299.000đ</div>
            <div class="actions">
              <button class="btn outline btn-view">Xem nhanh</button>
              <button class="btn primary btn-add">Thêm vào giỏ</button>
              <button class="btn outline btn-buy">Mua Shopee</button>
            </div>
          </div>
        </article>

        <!-- SP 2 -->
        <article class="card product" data-name="Bình giữ nhiệt Inox 800ml" data-price="189000"
                 data-summary="Giữ nóng/lạnh 8–12h, vỏ thép." data-url="https://shopee.vn/product-def">
          <div class="thumb">images/sp_binhgiu.jpg</div>
          <div class="body">
            <div class="title">Bình giữ nhiệt Inox 800ml</div>
            <div class="price">189.000đ</div>
            <div class="actions">
              <button class="btn outline btn-view">Xem nhanh</button>
              <button class="btn primary btn-add">Thêm vào giỏ</button>
              <button class="btn outline btn-buy">Mua Shopee</button>
            </div>
          </div>
        </article>

        <!-- SP 3 -->
        <article class="card product" data-name="Áo thun Basic Unisex" data-price="129000"
                 data-summary="Vải 280gsm, co giãn, form rộng." data-url="https://shopee.vn/product-shirt">
          <div class="thumb">images/sp_aothun.jpg</div>
          <div class="body">
            <div class="title">Áo thun Basic Unisex</div>
            <div class="price">129.000đ</div>
            <div class="actions">
              <button class="btn outline btn-view">Xem nhanh</button>
              <button class="btn primary btn-add">Thêm vào giỏ</button>
              <button class="btn outline btn-buy">Mua Shopee</button>
            </div>
          </div>
        </article>
      </div>
    </div>
  </section>

  <!-- ===== POP‑UP ===== -->
  <div id="popup" class="popup" aria-modal="true" role="dialog" aria-hidden="true">
    <div class="popupCard">
      <div class="popupHead">
        <div class="popupTitle" id="popupTitle">Tên sản phẩm</div>
        <button class="closeX" id="popupClose" aria-label="Đóng">×</button>
      </div>
      <div class="popupBody">
        <img id="popupImg" alt="Ảnh sản phẩm" />
        <div>
          <div style="color:#ffd7a2; font-weight:900" id="popupPrice">0đ</div>
          <div class="popup-summary" id="popupSummary">Mô tả ngắn…</div>
        </div>
      </div>
      <div class="popupActions">
        <a id="popupOpen" class="btn primary" target="_blank" rel="noopener">Mua Shopee →</a>
        <button class="btn outline" id="popupAdd">Thêm vào giỏ</button>
        <button class="btn outline" id="popupDismiss">Đóng</button>
      </div>
    </div>
  </div>

  <!-- ===== GIỎ HÀNG ===== -->
  <section id="giohang"></section>
  <aside id="drawer" class="drawer" aria-hidden="true">
    <div class="drawerHead">
      <strong>Giỏ hàng</strong>
      <button class="closeX" id="closeCart" aria-label="Đóng">×</button>
    </div>
    <div id="cartList" class="drawerList">
      <div class="empty">Giỏ đang trống</div>
    </div>
    <div class="drawerFoot">
      <div class="total"><span>Tổng</span><span id="cartTotal">0đ</span></div>
      <div class="drawerActions">
        <button id="checkoutShopee" class="btn primary">Mua trên Shopee</button>
        <button id="clearCart" class="btn outline">Xóa giỏ</button>
      </div>
    </div>
  </aside>

  <!-- Nút về đầu -->
  <button id="toTop" class="toTop" aria-label="Về đầu trang">↑</button>

  <script>
    (function(){
      /* ToTop */
      const btnTop=document.getElementById('toTop');
      addEventListener('scroll',()=>{ if(scrollY>240) btnTop.classList.add('show'); else btnTop.classList.remove('show'); },{passive:true});
      btnTop.addEventListener('click',()=>scrollTo({top:0,behavior:'smooth'}));

      /* Pop‑up */
      const popup=document.getElementById('popup');
      const popupImg=document.getElementById('popupImg');
      const popupTitle=document.getElementById('popupTitle');
      const popupPrice=document.getElementById('popupPrice');
      const popupSummary=document.getElementById('popupSummary');
      const popupOpen=document.getElementById('popupOpen');
      const popupAdd=document.getElementById('popupAdd');
      const popupClose=document.getElementById('popupClose');
      const popupDismiss=document.getElementById('popupDismiss');
      let currentItem=null;

      const fmtVND=v=>new Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND',maximumFractionDigits:0}).format(v||0);
      function openPopup(item){
        currentItem=item;
        popupTitle.textContent=item.name;
        popupPrice.textContent=fmtVND(item.price);
        popupSummary.textContent=item.summary||'';
        popupOpen.href=item.url||'#';
        popupImg.src=item.img||'';
        popup.classList.add('show'); popup.setAttribute('aria-hidden','false');
      }
      function closePopup(){ popup.classList.remove('show'); popup.setAttribute('aria-hidden','true'); currentItem=null; }
      popupClose.addEventListener('click',closePopup);
      popupDismiss.addEventListener('click',closePopup);
      popup.addEventListener('click',(e)=>{ if(e.target===popup) closePopup(); });
      addEventListener('keydown',(e)=>{ if(e.key==='Escape') closePopup(); });

      /* Cart */
      const CART_KEY='thor_cart';
      const drawer=document.getElementById('drawer');
      const openCart=document.getElementById('openCart');
      const closeCart=document.getElementById('closeCart');
      const cartList=document.getElementById('cartList');
      const cartTotal=document.getElementById('cartTotal');
      const checkoutShopee=document.getElementById('checkoutShopee');
      const clearCart=document.getElementById('clearCart');
      const cartCountEl=document.getElementById('cartCount');

      const getCart=()=>{ try{ return JSON.parse(localStorage.getItem(CART_KEY)||'[]'); }catch(e){ return []; } };
      const setCart=(items)=>{ localStorage.setItem(CART_KEY, JSON.stringify(items)); renderCart(); };
      const addToCart=(item)=>{ const items=getCart(); const i=items.findIndex(x=>x.name===item.name && x.url===item.url);
        if(i>=0) items[i].qty=(items[i].qty||1)+1; else items.push({...item, qty:1}); setCart(items); };
      const removeFromCart=(name)=>{ setCart(getCart().filter(x=>x.name!==name)); };

      function renderCart(){
        const items=getCart(); cartList.innerHTML='';
        if(!items.length){ cartList.innerHTML='<div class="empty">Giỏ đang trống</div>'; cartTotal.textContent='0đ'; cartCountEl.textContent='0'; return; }
        let total=0;
        items.forEach(it=>{
          total+=(it.price||0)*(it.qty||1);
          const row=document.createElement('div');
          row.className='drawerItem';
          row.innerHTML=`
            # alt="">
            <div class="meta">
              <div style="font-weight:900">${it.name}</div>
              <div style="color:#ffd7a2; font-weight:900">${fmtVND(it.price||0)} × ${it.qty||1}</div>
              ${it.url ? '#Mua →</a>' : ''}
            </div>
            <div><button class="btn outline btn-remove">Xóa</button></div>`;
          row.querySelector('img').src=it.img||'';
          row.querySelector('.btn-remove').addEventListener('click',()=>removeFromCart(it.name));
          const buy=row.querySelector('.btn-buy-row'); buy?.addEventListener('click',()=>{ if(it.url && it.url!=='#') window.open(it.url,'_blank','noopener'); });
          cartList.appendChild(row);
        });
        cartTotal.textContent=fmtVND(total);
        cartCountEl.textContent=items.reduce((s,x)=>s+(x.qty||1),0);
      }
      renderCart();

      openCart.addEventListener('click',()=>{ drawer.classList.add('show'); drawer.setAttribute('aria-hidden','false'); });
      closeCart.addEventListener('click',()=>{ drawer.classList.remove('show'); drawer.setAttribute('aria-hidden','true'); });
      checkoutShopee.addEventListener('click',()=>{
        const items=getCart().filter(x=>x.url && x.url!=='#');
        if(!items.length){ alert('Giỏ chưa có sản phẩm có link Shopee.'); return; }
        items.forEach((it,i)=>{ setTimeout(()=>window.open(it.url,'_blank','noopener'), i*120); });
      });
      clearCart.addEventListener('click',()=>{ if(confirm('Xóa toàn bộ giỏ hàng?')) setCart([]); });

      /* Bind sản phẩm */
      document.querySelectorAll('.product').forEach(card=>{
        const btnView=card.querySelector('.btn-view');
        const btnAdd=card.querySelector('.btn-add');
        const btnBuy=card.querySelector('.btn-buy');
        const getItem=()=>({
          name: card.getAttribute('data-name') || card.querySelector('.title')?.textContent?.trim() || '',
          price: parseInt(card.getAttribute('data-price')||'0',10),
          url: card.getAttribute('data-url') || '#',
          summary: card.getAttribute('data-summary') || '',
          img: card.querySelector('img')?.src || ''
        });
        card.addEventListener('click',(e)=>{ if(e.target.closest('.actions')) return; openPopup(getItem()); });
        btnView?.addEventListener('click',(e)=>{ e.stopPropagation(); openPopup(getItem()); });
        btnAdd?.addEventListener('click',(e)=>{ e.stopPropagation(); addToCart(getItem()); });
        btnBuy?.addEventListener('click',(e)=>{ e.stopPropagation(); const it=getItem(); if(it.url && it.url!=='#') window.open(it.url,'_blank','noopener'); });
      });

      /* Anchor focus nhẹ */
      addEventListener('hashchange',()=>{
        const t=document.getElementById(location.hash.slice(1));
        if(t){ t.setAttribute('tabindex','-1'); t.focus({preventScroll:true}); setTimeout(()=>t.removeAttribute('tabindex'),500); }
      });
    })();
  </script>
</body>
</html>
