
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Giỏ hàng của tôi — Thor</title>
  <meta name="description" content="Trang giỏ hàng cá nhân: trưng bày sản phẩm bằng ảnh riêng, hiệu ứng Tết đỏ–vàng, Quick View và giỏ hàng cục bộ." />

  <!-- THEME: Đỏ–Vàng Tết -->
  <style>
    :root{
      --bg:#3b0a19; --bg-alt:#541226;
      --gold:#f7c35f; --gold-2:#ffdf8a; --red:#d33636;
      --txt:#fff2f2; --txt-muted:#f0cfd1; --border:#7a2138;
      --shadow:0 26px 80px rgba(0,0,0,.45); --radius:18px; --wrap:1100px;
      --headerH:60px; /* chiều cao header */
    }

    /* Nền đỏ–vàng */
    html,body{
      margin:0; padding:0; color:var(--txt);
      font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;
      background:
        radial-gradient(1200px 480px at 15% -10%, rgba(255,223,138,.25), transparent 60%),
        radial-gradient(1100px 520px at 85% -20%, rgba(243,92,66,.20), transparent 60%),
        linear-gradient(180deg, #4e0f21 0%, #3b0a19 55%, #360816 100%);
    }
    a{ color:var(--gold); text-decoration:none }
    a:hover{ text-decoration:underline }
    img{ max-width:100%; display:block }
    .wrap{ max-width:var(--wrap); margin:0 auto; padding:0 22px }

    /* ===== HEADER mới (bỏ hashtag, có logo xe đẩy) ===== */
    .site-header{
      position:sticky; top:0; z-index:999; height:var(--headerH);
      background:rgba(84,18,38,.65); backdrop-filter:blur(10px) saturate(1.15);
      border-bottom:1px solid var(--border);
    }
    .nav{ height:100%; display:flex; align-items:center; justify-content:space-between }
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .logo{ width:36px; height:36px; display:grid; place-items:center;
      border-radius:12px; background:linear-gradient(135deg, var(--gold), var(--gold-2));
      box-shadow:0 8px 22px rgba(247,195,95,.35);
    }
    .logo svg{ width:24px; height:24px; fill:#3b0a19 }
    .brand-title{ font-weight:900; letter-spacing:.4px; font-size:18px; color:#fff }

    .menu{ display:flex; gap:18px; font-weight:800 }
    .menu a{ padding:8px 12px; border-radius:12px; color:#fff }
    .menu a:hover{ background:rgba(247,195,95,.15) }

    /* Nút giỏ hàng (góc phải) */
    .cart-btn{
      display:flex; align-items:center; gap:10px;
      background:linear-gradient(135deg, var(--gold), var(--gold-2));
      color:#3b0a19; border:none; padding:10px 14px; border-radius:999px;
      font-weight:900; cursor:pointer; box-shadow:0 10px 24px rgba(247,195,95,.35)
    }
    .cart-btn svg{ width:20px; height:20px; fill:#3b0a19 }
    .cart-count{ background:#3b0a19; color:#fff; border-radius:999px; padding:2px 8px; font-size:12px }

    /* ===== HERO ===== */
    .hero{ padding:28px 0 20px; border-bottom:1px solid var(--border) }
    .hero-title{ margin:.2rem 0 0; font-size:34px; line-height:1.08; font-weight:900;
      background:linear-gradient(90deg, var(--gold-2), #fff, var(--gold));
      -webkit-background-clip:text; background-clip:text; color:transparent }
    .hero p{ color:var(--txt-muted); max-width:720px; margin:10px 0 0 }

    /* ===== SECTION / GRID ===== */
    .section{ padding:32px 0; border-bottom:1px solid var(--border) }
    .section h3{ margin:0 0 16px; font-size:22px; font-weight:900; letter-spacing:.3px }
    .grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:16px }

    /* ===== CARD sản phẩm (hover “giờ” vàng) ===== */
    .card{
      border:1px solid var(--border); border-radius:var(--radius); background:var(--bg-alt);
      box-shadow:var(--shadow); overflow:hidden; display:flex; flex-direction:column;
    }
    .thumb{
      position:relative; aspect-ratio:4/3; background:#5a1430;
      display:flex; align-items:center; justify-content:center;
    }
    .thumb img{ width:100%; height:100%; object-fit:cover }
    /* vòng đồng hồ vàng */
    .thumb::before{
      content:""; position:absolute; inset:10px; border-radius:18px;
      background:conic-gradient(from 0deg, rgba(247,195,95,.0) 0deg, rgba(247,195,95,.65) 240deg, rgba(247,195,95,.0) 360deg);
      box-shadow:0 0 0 2px rgba(247,195,95,.35) inset, 0 0 24px rgba(247,195,95,.25);
      opacity:0; transform:scale(1.02);
    }
    .card:hover .thumb::before{ opacity:1; animation:spin 2.4s linear infinite }
    @keyframes spin{ to{ transform:scale(1.02) rotate(1turn) } }

    .body{ padding:14px 14px 16px }
    .brand-mini{ color:var(--gold); font-weight:800 }
    .title{ margin:.35rem 0 .4rem; font-weight:900; line-height:1.25 }
    .price{ color:#ffd7a2; font-weight:900 }
    .actions{ display:flex; gap:8px; margin-top:12px }
    .btn{ border:1px solid var(--border); border-radius:12px; padding:9px 12px; font-weight:800; cursor:pointer }
    .btn.primary{ background:linear-gradient(135deg, var(--gold), var(--gold-2)); color:#3b0a19; border-color:transparent }
    .btn.outline{ background:transparent; color:#fff }
    .btn:hover{ filter:brightness(1.05) }

    /* ===== POP‑UP ===== */
    .popup{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:1000;
      background:rgba(0,0,0,.55); backdrop-filter:blur(4px) }
    .popup.show{ display:flex }
    .popup-card{
      width:min(820px,92vw); border-radius:18px; border:1px solid var(--border);
      background:var(--bg-alt); color:var(--txt); box-shadow:0 28px 80px rgba(0,0,0,.55);
      transform:translateY(16px); opacity:0; animation:popIn .34s ease forwards
    }
    @keyframes popIn{ to{ transform:none; opacity:1 } }
    .popup-head{ padding:16px 18px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center }
    .popup-title{ margin:.2rem 0 0; font-size:20px; font-weight:900 }
    .popup-body{ padding:16px 18px; display:grid; grid-template-columns:280px 1fr; gap:16px; color:var(--txt-muted) }
    .popup-body img{ width:100%; border-radius:14px; border:1px solid var(--border) }
    .popup-actions{ padding:16px 18px; border-top:1px solid var(--border); display:flex; gap:10px; justify-content:flex-end }
    .close-x{ border:none; background:transparent; color:var(--gold); font-size:22px; cursor:pointer }

    /* ===== Drawer giỏ hàng ===== */
    .drawer{
      position:fixed; top:0; right:0; width:min(380px,92vw); height:100vh; background:var(--bg-alt); border-left:1px solid var(--border);
      box-shadow:-8px 0 24px rgba(0,0,0,.35); transform:translateX(100%); transition:transform .28s ease; z-index:1001
    }
    .drawer.show{ transform:none }
    .drawer-head{ display:flex; justify-content:space-between; align-items:center; padding:12px 14px; border-bottom:1px solid var(--border) }
    .drawer-list{ padding:12px 14px; display:flex; flex-direction:column; gap:12px; max-height:calc(100vh - 200px); overflow:auto }
    .drawer-item{ display:flex; gap:10px; border:1px solid var(--border); border-radius:12px; padding:10px; background:#61152f }
    .drawer-item img{ width:64px; height:64px; object-fit:cover; border-radius:8px; border:1px solid var(--border) }
    .drawer-item .meta{ flex:1 }
    .drawer-foot{ padding:12px 14px; border-top:1px solid var(--border); display:flex; flex-direction:column; gap:10px }
    .total{ display:flex; justify-content:space-between; font-weight:900 }
    .drawer-actions{ display:flex; gap:8px }
    .empty{ color:var(--txt-muted); text-align:center; padding:20px }

    /* Nút về đầu trang */
    .to-top{
      position:fixed; right:18px; bottom:18px; width:44px; height:44px; display:grid; place-items:center;
      border-radius:999px; background:linear-gradient(135deg, var(--gold), var(--gold-2));
      color:#3b0a19; font-weight:900; box-shadow:0 14px 38px rgba(247,195,95,.35);
      cursor:pointer; opacity:0; transform:translateY(14px); transition:opacity .3s ease, transform .3s ease; z-index:999
    }
    .to-top.show{ opacity:1; transform:none }
  </style>
</head>

<body>
  <!-- ===== HEADER (logo xe đẩy to vừa dòng, menu sạch) ===== -->
  <header class="site-header">
    <div class="wrap nav">
      <div class="brand">
        <div class="logo" aria-label="Giỏ hàng của tôi">
          <!-- SVG xe đẩy -->
          <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
            <path d="M7 18a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm10 0a2 2 0 1 0 .001 4.001A2 2 0 0 0 17 18zM6.2 6h13.6l-1.4 7H8.3l-.6-3H4V8h3.1l-.3-2zM4 6V4h2l1 5h10l1.5-8H6.1L5.8 1H1v2h3l.2 3z"/>
          </svg>
        </div>
        <div class="brand-title">Giỏ hàng của tôi</div>
      </div>

      <nav class="menu">
        #sanphamSản phẩm</a>
        #giohangGiỏ hàng</a>
      </nav>

      <button id="openCart" class="cart-btn" aria-label="Mở giỏ hàng">
        <!-- icon nhỏ trong nút -->
        <svg viewBox="0 0 24 24"><path d="M7 18a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm10 0a2 2 0 1 0 .001 4.001A2 2 0 0 0 17 18zM6.2 6h13.6l-1.4 7H8.3l-.6-3H4V8h3.1l-.3-2z"/></svg>
        <span>Giỏ hàng</span>
        <span id="cartCount" class="cart-count">0</span>
      </button>
    </div>
  </header>

  <!-- ===== HERO ===== -->
  <section class="hero">
    <div class="wrap">
      <h2 class="hero-title">Bộ sưu tập Tết — Ảnh riêng</h2>
      <p>Rê chuột vào sản phẩm để xem “vòng giờ” vàng chạy quanh ảnh. Click để xem nhanh, thêm vào giỏ, hoặc mở link Shopee.</p>
    </div>
  </section>

  <!-- ===== SẢN PHẨM ===== -->
  <section id="sanpham" class="section">
    <div class="wrap">
      <h3>Sản phẩm</h3>
      <div class="grid">
        <!-- MẪU 1 -->
        <article class="card product" data-name="Tai nghe Bluetooth X12" data-price="299000"
                 data-summary="Pin 30h, chống ồn, sạc nhanh." data-url="https://shopee.vn/product-abc">
          <div class="thumb">
            images/sp_tainghe.jpg
          </div>
          <div class="body">
            <div class="brand-mini">Shop Thor</div>
            <div class="title">Tai nghe Bluetooth X12</div>
            <div class="price">299.000đ</div>
            <div class="actions">
              <button class="btn outline btn-view">Xem nhanh</button>
              <button class="btn primary btn-add">Thêm vào giỏ</button>
              <button class="btn outline btn-buy">Mua Shopee</button>
            </div>
          </div>
        </article>

        <!-- MẪU 2 -->
        <article class="card product" data-name="Bình giữ nhiệt Inox 800ml" data-price="189000"
                 data-summary="Giữ nóng/lạnh 8–12h, vỏ thép." data-url="https://shopee.vn/product-def">
          <div class="thumb">
            images/sp_binhgiu.jpg
          </div>
          <div class="body">
            <div class="brand-mini">Shop Thor</div>
            <div class="title">Bình giữ nhiệt Inox 800ml</div>
            <div class="price">189.000đ</div>
            <div class="actions">
              <button class="btn outline btn-view">Xem nhanh</button>
              <button class="btn primary btn-add">Thêm vào giỏ</button>
              <button class="btn outline btn-buy">Mua Shopee</button>
            </div>
          </div>
        </article>

        <!-- MẪU 3 -->
        <article class="card product" data-name="Áo thun Basic Unisex" data-price="129000"
                 data-summary="Vải 280gsm, co giãn, form rộng." data-url="https://shopee.vn/product-shirt">
          <div class="thumb">
            images/sp_aothun.jpg
          </div>
          <div class="body">
            <div class="brand-mini">Shop Thor</div>
            <div class="title">Áo thun Basic Unisex</div>
            <div class="price">129.000đ</div>
            <div class="actions">
              <button class="btn outline btn-view">Xem nhanh</button>
              <button class="btn primary btn-add">Thêm vào giỏ</button>
              <button class="btn outline btn-buy">Mua Shopee</button>
            </div>
          </div>
        </article>
      </div>
    </div>
  </section>

  <!-- POP‑UP QUICK VIEW -->
  <div id="popup" class="popup" aria-modal="true" role="dialog" aria-hidden="true">
    <div class="popup-card">
      <div class="popup-head">
        <div class="popup-title" id="popupTitle">Tên sản phẩm</div>
        <button class="close-x" id="popupClose" aria-label="Đóng">×</button>
      </div>
      <div class="popup-body">
        <img id="popupImg" alt="Ảnh sản phẩm" />
        <div>
          <div style="color:#ffd7a2; font-weight:900" id="popupPrice">0đ</div>
          <div class="popup-summary" id="popupSummary">Mô tả ngắn…</div>
        </div>
      </div>
      <div class="popup-actions">
        <a id="popupOpen" class="btn primary" target="_blank" rel="noopener">Mua Shopee →</a>
        <button class="btn outline" id="popupAdd">Thêm vào giỏ</button>
        <button class="btn outline" id="popupDismiss">Đóng</button>
      </div>
    </div>
  </div>

  <!-- GIỎ HÀNG -->
  <section id="giohang"></section>
  <aside id="drawer" class="drawer" aria-hidden="true">
    <div class="drawer-head">
      <strong>Giỏ hàng</strong>
      <button class="close-x" id="closeCart" aria-label="Đóng">×</button>
    </div>
    <div id="cartList" class="drawer-list">
      <div class="empty">Giỏ đang trống</div>
    </div>
    <div class="drawer-foot">
      <div class="total"><span>Tổng</span><span id="cartTotal">0đ</span></div>
      <div class="drawer-actions">
        <button id="checkoutShopee" class="btn primary">Mua trên Shopee</button>
        <button id="clearCart" class="btn outline">Xóa giỏ</button>
      </div>
    </div>
  </aside>

  <!-- Nút về đầu -->
  <button id="toTop" class="to-top" aria-label="Về đầu trang">↑</button>

  <!-- JS -->
  <script>
    (function(){
      /* Nút về đầu */
      const btnTop=document.getElementById('toTop');
      addEventListener('scroll',()=>{ if(scrollY>240) btnTop.classList.add('show'); else btnTop.classList.remove('show'); },{passive:true});
      btnTop.addEventListener('click',()=>scrollTo({top:0,behavior:'smooth'}));

      /* Pop‑up */
      const popup=document.getElementById('popup');
      const popupImg=document.getElementById('popupImg');
      const popupTitle=document.getElementById('popupTitle');
      const popupPrice=document.getElementById('popupPrice');
      const popupSummary=document.getElementById('popupSummary');
      const popupOpen=document.getElementById('popupOpen');
      const popupAdd=document.getElementById('popupAdd');
      const popupClose=document.getElementById('popupClose');
      const popupDismiss=document.getElementById('popupDismiss');
      let currentItem=null;

      function formatVND(v){ return new Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND',maximumFractionDigits:0}).format(v||0); }
      function openPopup(item){
        currentItem=item;
        popupTitle.textContent=item.name;
        popupPrice.textContent=formatVND(item.price||0);
        popupSummary.textContent=item.summary||'';
        popupOpen.href=item.url||'#';
        popupImg.src=item.img||'';
        popup.classList.add('show');
        popup.setAttribute('aria-hidden','false');
      }
      function closePopup(){ popup.classList.remove('show'); popup.setAttribute('aria-hidden','true'); currentItem=null; }
      popupClose.addEventListener('click',closePopup);
      popupDismiss.addEventListener('click',closePopup);
      popup.addEventListener('click',(e)=>{ if(e.target===popup) closePopup(); });
      addEventListener('keydown',(e)=>{ if(e.key==='Escape') closePopup(); });

      /* Cart (localStorage) */
      const CART_KEY='thor_cart';
      const drawer=document.getElementById('drawer');
      const openCart=document.getElementById('openCart');
      const closeCart=document.getElementById('closeCart');
      const cartList=document.getElementById('cartList');
      const cartTotal=document.getElementById('cartTotal');
      const checkoutShopee=document.getElementById('checkoutShopee');
      const clearCart=document.getElementById('clearCart');
      const cartCountEl=document.getElementById('cartCount');

      function getCart(){ try{ return JSON.parse(localStorage.getItem(CART_KEY)||'[]'); }catch(e){ return []; } }
      function setCart(items){ localStorage.setItem(CART_KEY, JSON.stringify(items)); renderCart(); }
      function addToCart(item){
        const items=getCart(); const idx=items.findIndex(x=>x.name===item.name && x.url===item.url);
        if(idx>=0) items[idx].qty=(items[idx].qty||1)+1; else items.push({...item, qty:1});
        setCart(items);
      }
      function removeFromCart(name){ const items=getCart().filter(x=>x.name!==name); setCart(items); }
      function renderCart(){
        const items=getCart(); cartList.innerHTML='';
        if(!items.length){ cartList.innerHTML='<div class="empty">Giỏ đang trống</div>'; cartTotal.textContent='0đ'; cartCountEl.textContent='0'; return; }
        let total=0;
        items.forEach(it=>{
          total+=(it.price||0)*(it.qty||1);
          const row=document.createElement('div');
          row.className='drawer-item';
          row.innerHTML=`
            # alt="">
            <div class="meta">
              <div style="font-weight:900">${it.name}</div>
              <div style="color:#ffd7a2; font-weight:900">${formatVND(it.price||0)} × ${it.qty||1}</div>
              ${it.url ? '#Mua →</a>' : ''}
            </div>
            <div>
              <button class="btn outline btn-remove">Xóa</button>
            </div>`;
          row.querySelector('img').src=it.img||'';
          row.querySelector('.btn-remove').addEventListener('click',()=>removeFromCart(it.name));
          const buy=row.querySelector('.btn-buy-row');
          buy?.addEventListener('click',()=>{ if(it.url && it.url!=='#') window.open(it.url,'_blank','noopener'); });
          cartList.appendChild(row);
        });
        cartTotal.textContent=formatVND(total);
        cartCountEl.textContent=items.reduce((s,x)=>s+(x.qty||1),0);
      }
      renderCart();

      openCart.addEventListener('click',()=>{ drawer.classList.add('show'); drawer.setAttribute('aria-hidden','false'); });
      closeCart.addEventListener('click',()=>{ drawer.classList.remove('show'); drawer.setAttribute('aria-hidden','true'); });
      checkoutShopee.addEventListener('click',()=>{
        const items=getCart().filter(x=>x.url && x.url!=='#');
        if(!items.length){ alert('Giỏ chưa có sản phẩm có link Shopee.'); return; }
        items.forEach((it,i)=>{ setTimeout(()=>window.open(it.url,'_blank','noopener'), i*120); });
      });
      clearCart.addEventListener('click',()=>{ if(confirm('Xóa toàn bộ giỏ hàng?')) setCart([]); });

      /* Bind sản phẩm */
      document.querySelectorAll('.product').forEach(card=>{
        const btnView=card.querySelector('.btn-view');
        const btnAdd=card.querySelector('.btn-add');
        const btnBuy=card.querySelector('.btn-buy');
        function getItem(){
          const name=card.getAttribute('data-name')||card.querySelector('.title')?.textContent?.trim()||'';
          const price=parseInt(card.getAttribute('data-price')||'0',10);
          const url=card.getAttribute('data-url')||'#';
          const summary=card.getAttribute('data-summary')||'';
          const img=card.querySelector('img')?.src||'';
          return {name,price,url,summary,img};
        }
        card.addEventListener('click',(e)=>{ if(e.target.closest('.actions')) return; openPopup(getItem()); });
        btnView?.addEventListener('click',(e)=>{ e.stopPropagation(); openPopup(getItem()); });
        btnAdd?.addEventListener('click',(e)=>{ e.stopPropagation(); addToCart(getItem()); });
        btnBuy?.addEventListener('click',(e)=>{ e.stopPropagation(); const it=getItem(); if(it.url && it.url!=='#') window.open(it.url,'_blank','noopener'); });
      });

      /* Anchor focus nhẹ */
      addEventListener('hashchange',()=>{
        const t=document.getElementById(location.hash.slice(1));
        if(t){ t.setAttribute('tabindex','-1'); t.focus({preventScroll:true}); setTimeout(()=>t.removeAttribute('tabindex'),500); }
      });
    })();
  </script>
</body>
</html>
